<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../../main.css"/>
	<style>
@font-face{
	font-family: "Mojangles";
	src: url("../../Mojangles.ttf");
}
#main{
	position: fixed;
	left: 0px;
	top: 0px;
	width: 100%;
	height: 100%;
}
#description{
	position: fixed;
	z-index: 999;
	right: 10px;
	top: 10px;
	bottom: 10px;
	width: 240px;
	background-color: rgba(240, 240, 240, .8);
	font-family: Mojangles;
	tabindex: -1;
}
#description .title{
	margin-left: 56px;
	margin-top: 14px;
	margin-bottom: 16px;
	margin-right: 40px;
	font-size: 32px;
	tabindex: -1;
}
#description .content{
	margin-left: 16px;
	margin-right: 16px;
	line-height: 20px;
	margin-top: 0px;
	font-size: 16px;
	tabindex: -1;
}
#description img{
	position: relative;
	left: 16px;
	top: 16px;
	width: 32px;
	image-rendering: pixelated;
	float: left;
	tabindex: -1;
}
#description #close{
	font-family: Mojangles;
	font-size: 24px;
	padding-left: 8px;
	padding-bottom: 4px;
	position: absolute;
	right: 8px;
	top: 8px;
	width: 32px;
	height: 32px;
	border: none;
	background-color: transparent;
}
#description #close:hover{
	position: absolute;
	right: 8px;
	top: 8px;
	border: none;
	background-color: rgba(255, 255, 255, 0.8);
}
#description #close:active{
	position: absolute;
	right: 8px;
	top: 8px;
	border: none;
	background-color: rgba(64, 64, 64, 0.5);
}
	</style>
    <title>ÊúçÂä°Âô®Âú∞Âõæ</title>
</head>
<body>
    <div id="div_menu">
		<a style="margin-right:10px;" href="javascript:history.go(-1)">
			<b style="font-weight:60;font-size:24px;line-height:24px;">‚Üê</b>
			ËøîÂõû
		</a>
        <a href="../../" style="cursor:pointer;display:flex;">
            <img style="width:24px;height:24px;margin-top:1px;" src="../../icon.png"/>
			<p style="text-decoration:none;color:black;font-weight:60;font-size:20px;font-family:Consolas;text-align:center;margin:0px;margin-left:7px;padding:0px;">NFLS 202209 MCÊúçÂä°Âô®</p>
        </a>
        <a href="../../">‰∏ªÈ°µ</a>
        <a href="../../tutorial/">ÊïôÁ®ã</a>
        <a href="../../apps/">Â∫îÁî®</a>
    </div>
	<canvas id="main"></canvas>
	<div id="description" style="display: none;"></div>
</body>
<script>
const menu = document.getElementById("div_menu");
const canvas = document.getElementById("main");
const description = document.getElementById("description");
const cxt = canvas.getContext("2d");
var width = 0;
var height = 0;
var ox = parseFloat(localStorage.getItem("ox"));
if(isNaN(ox) || !isFinite(ox)) ox = 0.0;
var oy = parseFloat(localStorage.getItem("oy"));
if(isNaN(oy) || !isFinite(oy)) oy = 0.0;
var sc = parseFloat(localStorage.getItem("sc"));
if(isNaN(sc) || !isFinite(sc)) sc = 1.0;

var images = [];
var tags = [];
let chosen = null;

function updateDescription(){
	if(chosen == null){
		description.style.display = "none";
		return;
	}
	description.style.display = "";
	description.innerHTML = "<img src=\"" + chosen.img.src + "\"/><p class=\"title\">" + chosen.name + "</p><p class=\"content\">" + chosen.desc + "</p><button id=\"close\" onclick=\"chosen.ac = false; chosen = null; repaint(); updateDescription(); \">x</button>";
}

function repaint(){
	tags.sort(function (a, b){return a.ac * 1000 + a.y - b.ac * 1000 - b.y;});
	cxt.imageSmoothingEnabled = false;
	cxt.clearRect(0, 0, width, height);
	for(var i = 0; i < images.length; ++i){
		[img, x, y, s] = images[i];
		cxt.drawImage(img, width / 2 + ox + (x - 128 * s / 2) * sc, height / 2 + oy + (y - 128 * s / 2) * sc, 128 * s * sc, 128 * s * sc);
	}
	for(var i = 0; i < tags.length; ++i){
		img = tags[i].img,
		x = tags[i].x,
		z = tags[i].z,
		ac = tags[i].ac;
		var tx = Math.round(width / 2 + ox + x * sc);
		var ty = Math.round(height / 2 + oy + z * sc);
		if(ac){
			cxt.drawImage(img, tx - 20, ty - 20, 40, 40);
			cxt.lineWidth = '2';
			cxt.strokeStyle = 'black';
			cxt.strokeRect(tx - 22, ty - 21, 42, 42);
			cxt.strokeStyle = 'white';
			cxt.strokeRect(tx - 24, ty - 23, 46, 46);
		}else{
			cxt.drawImage(img, tx - 16, ty - 16, 32, 32);
			cxt.lineWidth = '1';
			cxt.strokeStyle = 'black';
			cxt.strokeRect(tx - 17, ty - 17, 33, 33);
			cxt.strokeStyle = 'white';
			cxt.strokeRect(tx - 18, ty - 18, 35, 35);
		}
	}
}

function loadImage(src, x, y, s){
	var img = new Image();
	img.src = src;
	img.onload = () => {
		images.push([img, x, y, s]);
		images.sort(function (a, b){return b[3] - a[3]; });
		repaint();
	}
}

function loadTag(src, x, y, z, name, desc){
	var img = new Image();
	img.src = src;
	img.onload = () => {
		tags.push({
			img: img,
			x: x,
			y: y,
			z: z,
			name: name,
			desc: desc,
			ac: false
		});
		repaint();
	}
}

var leftClick = false;
var lx = null;
var ly = null;

canvas.onmousedown = function(){
	var event = event || window.event;
	if(event.button == 0){
		leftClick = true;
		lx = event.offsetX;
		ly = event.offsetY;
		var fl = true;
		tags.sort(function (a, b){return a.ac * 1000 + a.y - b.ac * 1000 - b.y;});
		for(var i = 0; i < tags.length; ++i){
			x = tags[i].x,
			z = tags[i].z;
			var tx = Math.round(width / 2 + ox + x * sc);
			var ty = Math.round(height / 2 + oy + z * sc);
			if(tx - 16 <= lx && lx < tx + 16 && ty - 16 <= ly && ly < ty + 16){
				if(chosen != null) chosen.ac = false;
				chosen = tags[i];
				chosen.ac = true;
				fl = false;
			}
		}
		if(fl){
			if(chosen != null) chosen.ac = false;
			chosen = null;
		}
		updateDescription();
		repaint();
	}
}

canvas.onmouseup = function(){
	var event = event || window.event;
	if(event.button == 0){
		leftClick = false;
		lx = null;
		ly = null;
	}
}

canvas.onmouseout = function(){
	leftClick = false;
	lx = null;
	ly = null;
}

canvas.onmousemove = function(){
	var event = event || window.event;
	if(leftClick && lx != null && ly != null){
		ox += event.offsetX - lx;
		oy += event.offsetY - ly;
		lx = event.offsetX;
		ly = event.offsetY;
		repaint();
	}
}

canvas.onmousewheel = function(){
	var event = event || window.event;
	var rsc = sc;
	var p = Math.pow(0.998, event.deltaY);
	sc *= p;
	const U = Math.pow(0.998, -1000);
	const D = Math.pow(0.998, 1000);
	if(sc > U) sc = U, p = U / rsc;
	if(sc < D) sc = D, p = D / rsc;
	var px = event.offsetX - width / 2;
	var py = event.offsetY - height / 2;
	ox = px + (ox - px) * p;
	oy = py + (oy - py) * p;
	repaint();
	return false;
}

function resizeEvent(){
	canvas.style.top = menu.clientHeight + "px";
	width = canvas.width = canvas.clientWidth;
	height = canvas.height = canvas.clientHeight;
	description.style.top = (10 + menu.clientHeight) + "px";
	repaint();
}

window.onresize = resizeEvent;
resizeEvent();

window.onunload = function (){
	localStorage.setItem("ox", ox);
	localStorage.setItem("oy", oy);
	localStorage.setItem("sc", sc);
}

imgSrc = ['0 256 384.png', '0 3456 -1280.png', '0 3456 -1408.png', '0 384 384.png', '0 384 640.png', '0 384 768.png', '0 512 -128.png', '0 512 640.png', '0 512 768.png', '0 640 -128.png', '0 640 -256.png', '0 640 640.png', '3 -576 -576.png', '3 -576 448.png', '3 1472 -576.png', '3 1472 448.png', '3 2496 -576.png', '3 2496 448.png', '3 3520 -1600.png', '3 448 -576.png', '3 448 1472.png', '3 448 448.png'];

for(var i = 0; i < imgSrc.length; ++i){
	[s, x, y] = imgSrc[i].match(/[-\d]+/g);
	s = parseInt(s),
	x = parseInt(x),
	y = parseInt(y);
	loadImage("./terrain/" + imgSrc[i], x, y, 1 << s);
}

loadTag("./icons/iron_golem.png", 630, 62, -191, "Âà∑ÈìÅÂ°î", "Chong_Sheng Âú®ÂâçÂâçÊúüÂÅöÁöÑÂà∑ÈìÅÂ°îÔºåÁâπÂà´Â•ΩÁî®„ÄÇ‰∏ÄÂºÄÂßãÊïàÁéáÂæà‰ΩéÔºåÊ≤°ÊÉ≥Âà∞Á´üÊòØÊúç‰∏ªÂøò‰∫ÜÂºÄÂõ∞Èöæ„ÄÇ");
loadTag("./icons/villager.png", 653, 66, -160, "ÊùëÊ∞ëÁπÅÊÆñ", "Chong_Sheng Âú®ÂºÄÊúçÁ¨¨‰∏ÄÂ§©ÂÅöÁöÑÊùëÊ∞ëÁπÅÊÆñÔºå‰Ωç‰∫éÂΩìÂàùÁ´πÂ≤õÊùëÂ∫ÑÁöÑ‰∏≠ÂøÉ„ÄÇ‰∏∫ÊùëÊ∞ë‰∫§ÊòìÊâÄÂíåÂà∑ÈìÅÂ°îË¥°ÁåÆÊûÅÂ§ß„ÄÇ");
loadTag("./icons/oak_sapling.png", 684, 66, -172, "ÁÆÄÊòìÊ†ëÂú∫", "Chong_Sheng Âà∂ÈÄ†ÁöÑÁÆÄÂçïÊ†ëÂú∫„ÄÇÊïàÁéá‰∏çÈ´ò‰ΩÜÊòØ‰ªÄ‰πàÊ†ëÁßçÈÉΩÂèØ‰ª•Áîü‰∫ß„ÄÇÂÅá‰∫∫ hsds ÊòØËøôÈáåÁöÑÂ∏∏ÂÆ¢„ÄÇ");
loadTag("./icons/cobblestone.png", 609, 66, -119, "Âà∑Áü≥Êú∫", "zero_range Âà∂ÈÄ†ÁöÑÂ§ßÂèîÁâåÂà∑Áü≥Êú∫„ÄÇÁªùÂØπ‰∏çÊäóÂç∏ËΩΩÔºåÂºÄÊú∫‰∏ÄÂÆöË¶ÅÂ∞èÂøÉ„ÄÇÂùè‰∫ÜÊó†Êï∞Ê¨°Ôºå‰ΩÜ‰øÆËµ∑Êù•ÊûÅÂø´„ÄÇ‰∫ßÈáè‰∏çÈ´òÔºå‰∏çËøáÊöÇÊó∂Â§üÁî®„ÄÇ");
loadTag("./icons/crafting_table_top.png", 659, 64, -202, "Âñ∑Â∞ÑÂêàÊàêÁ´ô", "Chong_Sheng ÂÅöÁöÑÂñ∑Â∞ÑÂêàÊàêÁ´ô„ÄÇÈùûÂ∏∏Â•ΩÁî®„ÄÇÈúÄË¶ÅËæÖÂä©Ê®°ÁªÑ ItemScroller„ÄÅTweakeroo Âíå TweakerMore„ÄÇ");
loadTag("./icons/sugar_cane.png", 641, 67, -113, "Â∞èÁîòËîóÊú∫", "Chong_Sheng Âú®ÂâçÂâçÊúüÂÅöÁöÑÁîòËîóÊú∫„ÄÇ‰∏∫ÂÖ®ÊúçÁîü‰∫ß‰∫ÜÂ•ΩÂá†ÁõíÁÉüËä±ÂêéÂÖâËç£ÈÄÄ‰ºë„ÄÇ");
loadTag("./icons/pumpkin_top.png", 609, 66, -161, "Â∞èÂçóÁìúÊú∫", "zero_range ÈöèÊâãÈÄ†ÁöÑÂçóÁìúÊú∫„ÄÇÊú¨Ë¥®Âè™ÊòØÂè†ÂçïÁâá„ÄÇ‰∏çËøáÂ∞±Ëøô‰πüËÆ© zero_range ÈÄ†Èîô‰∫ÜÂá†Ê¨°„ÄÇ");
loadTag("./icons/emerald.png", 654, 42, -175, "ÊùëÊ∞ë‰∫§Êòì", "‰Ωç‰∫éÂú∞‰∏ã‰∫åÂ±Ç„ÄÇÂÖ±ÂêåÂà∂‰ΩúÁöÑÊùëÊ∞ë‰∫§ÊòìÊâÄÔºåÈÖçÂ•óÂà∑Á∫øÊú∫ÔºåÊã•ÊúâÂ∏∏Áî®ÊùëÊ∞ëÂíåÂÖ®Â•óÈôÑÈ≠î‰π¶‰∫§Êòì„ÄÇÂéüÂùÄ‰Ωç‰∫éÁ´πÂ≤õÂçóÈÉ®ÔºåÁé∞Â∑≤ÊãÜÈô§„ÄÇ");
loadTag("./icons/furnace_front_on.png", 664, 52, -152, "40ÈÄüÁÜîÁÇâÁªÑ", "‰Ωç‰∫éÂú∞‰∏ã‰∏ÄÂ±Ç„ÄÇÁî± zero_range Âíå Chong_Sheng Âà∂ÈÄ†ÔºåËÉΩÂø´ÈÄüÁÉß‰∏úË•ø„ÄÇÊäóÂç∏ËΩΩÔºå‰ΩÜÊòØ‰∏çË¶ÅÂú®ÁÉß‰∏úË•øÁöÑÊó∂ÂÄôÂÖ≥Êéâ„ÄÇËÉΩÂêÑÁßçÂêÑÊ†∑Âú∞ÂùèÔºå‰ΩÜÊòØ‰∏çÂ¶®Á¢çÂÆÉÂ•ΩÁî®„ÄÇ");
loadTag("./icons/slime_ball.png", 3467, 181, -1358, "Ê≤ºÊ≥ΩÂà∑ÊÄ™Â°î", "zero_range Âà∂‰ΩúÁöÑÊ≤ºÊ≥ΩÂà∑ÊÄ™Â°î„ÄÇÈùûÂ∏∏Â•ΩÁî®Ôºå‰∏çËøáË∑ØÁ®ãÊúâÁÇπÂÑøËøú„ÄÇ");
loadTag("./icons/nahida.png", 448, 64, 704, "ÂÉèÁ¥†Áîª-Á∫≥Ë•øÂ¶≤", "Áî± zero_range Êèê‰æõÊäïÂΩ±ÂíåÊùêÊñôÔºåChong_Sheng Âíå zero_range ËÅîÂêàÂà∂‰ΩúÁöÑ 256*256 ÂÉèÁ¥†Áîª„ÄÇÁî±‰∫é zero_range ÁöÑ‰ª£Á†Å‰∏≠ÁöÑ‰∏Ä‰∏™ÈîôËØØÔºåÂÉèÁ¥†ÁîªÊØîÂéüÂõæÊòæÂæó‰∫Æ‰∏Ä‰∫õÔºåËÄå‰∏îÊúâ‰∫õÂ§±Áúü„ÄÇ‰∏çËøá Chong_Sheng ÂØπÊ≠§ÂæàÊª°ÊÑè„ÄÇChong_Sheng ËØÑ‰ª∑ÔºöÂìàÂìàÂìàÔºÅü•µÊàëÁöÑÁ∫≥Ë•øÂ¶≤ÔºÅü•µÂìßÊ∫úÂìßÊ∫úÊñØÂìàÊñØÂìà¬•#$%&ü•µü•µü•µÔºÅ");
loadTag("./icons/genshin.png", 640, 64, 640, "ÂÉèÁ¥†Áîª-ÂéüÁ•û", "zero_range ÁîüÊàêÊäïÂΩ±Âπ∂Âíå Chong_ShengÔºà„ÄÅyzb?Ôºâ ‰∏ÄËµ∑Âà∂‰ΩúÁöÑÂÉèÁ¥†ÁîªÔºåË°®Ëææ‰∫ÜÂÖ®ÊúçÊàêÂëòÂÖ±ÂêåÁöÑÂøóÂêë„ÄÇË¢´Ë¥¥Âú®ÂêÑ‰∏™ÈáçË¶ÅÁöÑÂÖ¨ÂÖ±ËÆæÊñΩ‰∏ä‰ª•Ë°®Á§∫ÂÆÉ‰ª¨ÁöÑÈáçË¶ÅÊÄß„ÄÇ");
loadTag("./icons/end_portal_frame_top.png", 463, 21, 1553, "Êú´Âú∞‰º†ÈÄÅÈó®", "Êú´Âú∞‰º†ÈÄÅÈó®„ÄÇÊòØÈáçË¶ÅÁöÑ‰∫§ÈÄöÈÄöÈÅìÔºå‰πüÊòØÊú´Âú∞Èó®Âà∑Ê≤ôÊú∫ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ");
loadTag("./icons/sand.png", 463, 20, 1555, "Êú´Âú∞Èó®Âà∑Ê≤ôÊú∫", "Chong_Sheng Âà∂‰ΩúÁöÑÂà∑Ê≤ôÊú∫„ÄÇChong_Sheng ËØ¥ÂºÄÊú∫Êó∂‰∫∫‰∏ÄÂÆöË¶ÅÂæÖÂú®Êú´Âú∞„ÄÇÂùèËøá‰∏ÄÊ¨°Ôºå‰ΩÜ Chong_Sheng ÂÖâÈÄü‰øÆÂ•Ω„ÄÇ");
loadTag("./icons/light_blue_concrete_powder.png", 669, 274, 64, "Á•≠ÂùõÂà∑Ê≤ôÊî∂ÈõÜ‰∏éÊ∑∑ÂáùÂúüÂõ∫Âåñ", "Chong_Sheng ÁöÑ‰ΩúÂìÅ„ÄÇChong_Sheng ‰∏ÄÁõ¥ÊÉ≥ÊääÂÆÉÊç¢ÊàêËá™ÈÄÇÂ∫îÊâìÂåÖÊî∂ÈõÜÔºå‰∏çËøáÂÅöÂÉèÁ¥†ÁîªÊó∂ËøòÊå∫Â•ΩÁî®„ÄÇ");
loadTag("./icons/magma_cube.png", 248, 79, 400, "Â≤©ÊµÜÊÄ™Â°îÊî∂ÈõÜ", "zero_range Âà∂‰ΩúÁöÑÊú∫Âô®„ÄÇËá™‰ªé‰ΩøÁî®Â≤©ÊµÜÂùóÁöÑÂÉµÂ∞∏Áå™ÁÅµÂ°î‰øÆÂ•Ω‰∫Ü‰πãÂêéÂ∞±Âá†‰πéÊ≤°ÊúâÂºÄÊú∫Ëøá„ÄÇ");

</script>
</html>
